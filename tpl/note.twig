{# Note edit and view #}
{% extends 'layout.twig' %}

{% block container %}

<nav class="breadcrumb" aria-label="breadcrumbs">
    <ul>
        <li><a href="/">Notes</a></li>
        <li class="is-active"><a href="/note">{{ title|default('New') }}</a></li>
    </ul>
</nav>

<form method="POST" action="">

    {%  if errorMsg %}
        <div class="notification is-warning is-light">
            <button class="delete"></button>
            {{ errorMsg }}
        </div>
    {% endif %}

    <div class="field">
        <div class="control">
            <input type="text" name="title" value="{{ title }}" placeholder="Note title" class="input">
        </div>
    </div>


    <div class="field">
        <div class="control">
            <textarea name="text" class="textarea is-info" id="note-edit" rows="25">{{ text }}</textarea>
        </div>
    </div>

    <input type="submit" value="[ Save ]" class="button is-info">
</form>

<p>
    To attach image or screenshot: first press <code>Ctrl+Shift+PrntScrn</code>,
    than paste it by pressing <code>Ctrl+V</code>.
</p>


{% endblock %}

{% block javascript %}
<script>
document.addEventListener('DOMContentLoaded', () => {
    (document.querySelectorAll('.notification .delete') || []).forEach(($delete) => {
        $notification = $delete.parentNode;

        $delete.addEventListener('click', () => {
            $notification.parentNode.removeChild($notification);
        });
    });
});
</script>

<script src="public/js/pasteimage.js"></script>
<script>
    new AGTextareaUploader(
        document.getElementById('note-edit'),
        '/paste-image'
    ).run();
</script>
{% endblock %}
